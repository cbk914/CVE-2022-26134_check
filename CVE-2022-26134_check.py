# CVE-2022-26134 Confluence RCE checker
# Author cbk914
import argparse
import requests

# Define command line flag for target URL
parser = argparse.ArgumentParser(description="Check for Confluence vulnerability")
parser.add_argument("-t", "--target", required=True, help="Target URL")
args = parser.parse_args()

# Send the request
try:
    response = requests.get(f"{args.target}/rest/tinymce/1/macro/preview", timeout=3)
    if response.status_code == 200 and "Confluence" in response.text and "com.atlassian.confluence.extra.jira" in response.text:
        print("VULNERABLE: The target is vulnerable to Confluence Remote Code Execution")
    else:
        print("SAFE: The target is not vulnerable to Confluence Remote Code Execution")
except requests.exceptions.RequestException as e:
    print(f"Error connecting to {args.target}: {e}")
